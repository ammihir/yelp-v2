:root{
  --yelp-red:#d32323;
  --yelp-red-2:#ff3b30;
  --bg-0:#050509;
  --bg-1:#0b0b10;
  --card:rgba(18,18,24,0.92);
  --stroke:rgba(255,255,255,0.10);
  --text:#f5f5f5;
  --text-dim:rgba(255,255,255,0.72);
  --placeholder:rgba(255,255,255,0.42);
  --focus:rgba(211,35,35,0.55);
  --btn-soft:rgba(255,255,255,0.10);
  --shadow:0 10px 30px rgba(0,0,0,0.45);
}

*,
*::before,
*::after{ box-sizing:border-box; }

html,body{
  margin:0;
  padding:0;
  height:100%;
  font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
  background:var(--bg-0);
  color:var(--text);
}

body{
  padding-top:env(safe-area-inset-top);
  padding-bottom:env(safe-area-inset-bottom);
}

/* Screens */
.screen{ display:none; height:100%; flex-direction:column; }
.screen.active{ display:flex; }

/* App shell */
.app{
  height:100vh;
  max-width:650px;
  margin:0 auto;
  display:flex;
  flex-direction:column;
  background:radial-gradient(circle at top, rgba(211,35,35,0.18), var(--bg-0) 55%);
}

/* Header */
.app-header{
  flex:0 0 auto;
  padding:0.8rem 1rem;
  display:flex;
  align-items:center;
  justify-content:space-between;
  backdrop-filter:blur(12px);
  border-bottom:1px solid var(--stroke);
  background:linear-gradient(90deg, rgba(211,35,35,0.18), rgba(5,5,9,0.92));
}
.app-title{ font-size:1.05rem; font-weight:600; }
.header-btn{
  border:none;
  border-radius:999px;
  padding:0.35rem 0.8rem;
  font-size:0.86rem;
  cursor:pointer;
  background:var(--btn-soft);
  color:var(--text);
}
.header-btn:active{ transform:scale(0.96); }

/* Chat */
.chat-container{
  flex:1 1 auto;
  overflow-y:auto;
  padding:0.75rem 0.75rem 1rem;
  display:flex;
  flex-direction:column;
  gap:0.45rem;
}
.message{
  max-width:80%;
  padding:0.55rem 0.75rem;
  border-radius:1rem;
  font-size:0.92rem;
  line-height:1.35;
  word-wrap:break-word;
  white-space:pre-wrap;
}
.message-user{
  background:linear-gradient(135deg, var(--yelp-red), var(--yelp-red-2));
  color:#fff;
}
.message-bot{
  background:rgba(16,16,22,0.92);
  border:1px solid var(--stroke);
}
.message.typing{
  opacity:0.7;
  font-style:italic;
}
.image-message img{
  max-width:220px;
  max-height:220px;
  border-radius:0.9rem;
  display:block;
}

/* Input bar */
.chat-input-bar{
  flex:0 0 auto;
  padding:0.6rem 0.6rem calc(0.6rem + env(safe-area-inset-bottom));
  display:flex;
  gap:0.45rem;
  align-items:center;
  border-top:1px solid var(--stroke);
  background:rgba(5,5,10,0.98);
}
.attach-btn{
  flex:0 0 auto;
  border-radius:999px;
  border:none;
  background:transparent;
  color:rgba(255,255,255,0.7);
  font-size:1.3rem;
  padding:0.3rem 0.6rem;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
}
.attach-btn:active{ transform:scale(0.95); }

.chat-input{
  flex:1 1 auto;
  border-radius:999px;
  padding:0.55rem 0.9rem;
  font-size:0.95rem;
  outline:none;
  border:1px solid rgba(255,255,255,0.16);
  background:rgba(0,0,0,0.55);
  color:var(--text);
}
.chat-input::placeholder{ color:var(--placeholder); }
.chat-input:focus{
  border-color:var(--yelp-red);
  box-shadow:0 0 0 2px var(--focus);
}

.chat-send-btn{
  flex:0 0 auto;
  border:none;
  border-radius:999px;
  padding:0.55rem 0.9rem;
  font-size:1.05rem;
  cursor:pointer;
  background:linear-gradient(135deg, var(--yelp-red), var(--yelp-red-2));
  color:#fff;
  box-shadow:var(--shadow);
}
.chat-send-btn:active{ transform:scale(0.97); }

/* Live */
.live-container{
  flex:1 1 auto;
  position:relative;
  overflow:hidden;
  background:#000;
}
.live-video{
  width:100%;
  height:100%;
  object-fit:cover;
}

.live-mask{
  position:absolute;
  inset:0;
  pointer-events:none;     
  background:transparent;   
  z-index:4;
}

.live-overlay{
  position:absolute;
  left:0;
  right:0;
  bottom:0;
  padding:0.9rem 0.75rem calc(0.9rem + env(safe-area-inset-bottom));
  background:linear-gradient(to top, rgba(0,0,0,0.78), transparent);
  color:var(--text);
  font-size:0.9rem;
  z-index:6;
}
.live-instructions{ opacity:0.9; }

/* Scan button + card */
.scan-btn{
  margin-top:0.5rem;
  border:none;
  border-radius:999px;
  padding:0.45rem 1rem;
  font-size:0.9rem;
  cursor:pointer;
  background:linear-gradient(135deg, var(--yelp-red), var(--yelp-red-2));
  color:#fff;
  box-shadow:var(--shadow);
}
.scan-btn:disabled{ opacity:0.6; cursor:default; }

.live-result-card{
  margin-top:0.6rem;
  background:var(--card);
  border:1px solid var(--stroke);
  border-radius:14px;
  padding:0.6rem 0.7rem;
}
.live-result-card.hidden{ display:none; }

.live-result-title{
  font-weight:600;
  margin-bottom:0.25rem;
  font-size:0.9rem;
}
.live-result-text{
  white-space:pre-wrap;
  max-height:8.5rem;
  overflow-y:auto;
  margin-bottom:0.5rem;
  line-height:1.35;
}
.live-result-buttons{
  display:flex;
  gap:0.5rem;
  flex-wrap:wrap;
}
.live-view-more-btn{
  border:none;
  border-radius:999px;
  padding:0.4rem 0.75rem;
  background:rgba(255,255,255,0.12);
  color:var(--text);
  cursor:pointer;
}
.live-view-more-btn:active{ transform:scale(0.96); }
.live-share-btn{
  border:none;
  border-radius:999px;
  padding:0.4rem 0.75rem;
  background:var(--yelp-red);
  color:#fff;
  cursor:pointer;
  font-weight:500;
  transition:background 0.15s, transform 0.1s;
}
.live-share-btn:hover{ background:#c62828; }
.live-share-btn:active{ transform:scale(0.96); }
.live-share-btn:disabled{ opacity:0.7; cursor:default; }
.live-share-btn.hidden{ display:none; }
.ai-badge{ font-size:0.7rem; opacity:0.7; margin-left:0.4rem; }

/* ========= THE FRAME (plain border) ========= */
.live-frame{
  position:absolute;
  top:20%;
  left:50%;
  transform:translateX(-50%);
  width:70%;
  height:40%;
  border-radius:24px;
  border:2px solid rgba(255,255,255,0.75);
  box-shadow:var(--shadow);
  z-index:5;
  pointer-events:auto;
  cursor:pointer;
  overflow:visible; /* allow glow outside */

}

/* ========= SCANNING NEON “ROPE” (flows, no rotation) ========= */
.live-frame.scanning{
  border-color: rgba(255,255,255,0.35); /* keep a faint glass edge behind neon */
}

/* neon ring */
.live-frame.scanning::before{
  content:"";
  position:absolute;
  inset:-2px;               /* match border thickness */
  border-radius:inherit;
  padding:2px;              /* thickness of neon ring */
  pointer-events:none;

  background:linear-gradient(
    90deg,
    #4dd7ff,
    #ffa92e,
    #2dff72,
    #32ade6,
    #5856d6,
    #4dd7ff
  );
  background-size:300% 100%;
  background-position:0% 50%;

  -webkit-mask:
    linear-gradient(#000 0 0) content-box,
    linear-gradient(#000 0 0);
  -webkit-mask-composite:xor;
  mask-composite:exclude;

  filter:
    blur(0.7px)
    drop-shadow(0 0 8px rgba(77,215,255,0.35))
    drop-shadow(0 0 14px rgba(255,169,46,0.25))
    drop-shadow(0 0 18px rgba(45,255,114,0.20));

  opacity:0.95;
  animation: led-flow 1.4s linear infinite;
}

/* inner tube highlight */
.live-frame.scanning::after{
  content:"";
  position:absolute;
  inset:1px;
  border-radius:calc(24px - 1px);
  pointer-events:none;
  box-shadow:
    inset 0 0 0 1px rgba(255,255,255,0.18),
    inset 0 0 10px rgba(255,255,255,0.06);
  opacity:0.9;
}

@keyframes led-flow{
  from { background-position:0% 50%; }
  to   { background-position:300% 50%; }
}

/* Mobile tweak */
@media (max-width:480px){
  .message{ max-width:90%; }
}


.yelp-badge{
  display:flex;
  align-items:center;
  gap:6px;
  padding:6px 10px;
  border-radius:999px;
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.12);
  font-size:11px;
  opacity:0.85;
  user-select:none;
}

.yelp-badge img{
  width:16px;
  height:16px;
  object-fit:contain;
  display:block;
}


.screen { display: none; height: 100%; }
.screen.active { display: flex; flex-direction: column; height: 100%; }
.app { height: 100vh; }

.app-header--grid{
  display:grid;
  grid-template-columns: 90px 1fr 90px;
  align-items:center;
  gap:8px;
}

.header-left{ display:flex; justify-content:flex-start; }
.header-right{ display:flex; justify-content:flex-end; }
.header-center{
  display:flex;
  flex-direction:column;
  align-items:center;
  justify-content:center;
  text-align:center;
  gap:2px;
}

.yelp-center{
  display:flex;
  align-items:center;
  gap:6px;
  font-size:11px;
  opacity:0.85;
}
.yelp-center img{
  width:16px;
  height:16px;
  display:block;
  object-fit:contain;
}

/* ========= LANGUAGE SELECTOR ========= */
.language-selector{
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.15);
  border-radius:8px;
  padding:0.35rem 0.6rem;
  font-size:0.82rem;
  color:var(--text);
  cursor:pointer;
  outline:none;
  min-width:100px;
  text-align:center;
  appearance:none;
  -webkit-appearance:none;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='10' height='6' viewBox='0 0 10 6'%3E%3Cpath fill='%23fff' fill-opacity='0.6' d='M5 6L0 0h10z'/%3E%3C/svg%3E");
  background-repeat:no-repeat;
  background-position:right 0.5rem center;
  padding-right:1.5rem;
}
.language-selector:hover{
  border-color:rgba(255,255,255,0.25);
}
.language-selector:focus{
  border-color:var(--yelp-red);
  box-shadow:0 0 0 2px var(--focus);
}
.language-selector option{
  background:var(--bg-1);
  color:var(--text);
}

/* ========= TTS BUTTON ========= */
.message{
  display:flex;
  flex-wrap:wrap;
  align-items:flex-start;
  gap:0.4rem;
}
.message-text{
  flex:1 1 auto;
  min-width:0;
}
.tts-btn{
  flex:0 0 auto;
  background:rgba(255,255,255,0.08);
  border:1px solid rgba(255,255,255,0.12);
  border-radius:50%;
  width:28px;
  height:28px;
  font-size:0.85rem;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0.7;
  transition:opacity 0.15s, background 0.15s;
  margin-top:2px;
}
.tts-btn:hover{
  opacity:1;
  background:rgba(255,255,255,0.12);
}
.tts-btn:active{
  transform:scale(0.92);
}
.tts-btn:disabled{
  opacity:0.4;
  cursor:default;
}

/* Adjust user message TTS position */
.message-user .tts-btn{
  background:rgba(0,0,0,0.15);
  border-color:rgba(0,0,0,0.2);
}

/* Hide TTS button initially on small screens for image messages */
.image-message .tts-btn{
  display:none;
}

/* ========= MICROPHONE BUTTON (STT) ========= */
.mic-btn{
  flex:0 0 auto;
  border:none;
  border-radius:50%;
  width:36px;
  height:36px;
  font-size:1.1rem;
  cursor:pointer;
  display:none; /* Hidden by default, shown via JS if STT enabled */
  align-items:center;
  justify-content:center;
  background:rgba(255,255,255,0.08);
  color:var(--text);
  transition:background 0.15s, transform 0.15s, box-shadow 0.15s;
}
.mic-btn:hover{
  background:rgba(255,255,255,0.15);
}
.mic-btn:active{
  transform:scale(0.95);
}
.mic-btn:disabled{
  opacity:0.5;
  cursor:default;
}

/* Recording state */
.mic-btn.recording{
  background:var(--yelp-red);
  animation:pulse-recording 1s ease-in-out infinite;
  box-shadow:0 0 0 0 rgba(211,35,35,0.5);
}

@keyframes pulse-recording{
  0%{
    box-shadow:0 0 0 0 rgba(211,35,35,0.5);
  }
  70%{
    box-shadow:0 0 0 8px rgba(211,35,35,0);
  }
  100%{
    box-shadow:0 0 0 0 rgba(211,35,35,0);
  }
}

/* ========= GROUP MODAL ========= */
.modal{
  position:fixed;
  inset:0;
  z-index:100;
  display:flex;
  align-items:center;
  justify-content:center;
  background:rgba(0,0,0,0.75);
  backdrop-filter:blur(4px);
}
.modal.hidden{
  display:none;
}
.modal-content{
  background:var(--bg-1);
  border:1px solid var(--stroke);
  border-radius:16px;
  padding:1.5rem;
  width:90%;
  max-width:380px;
  position:relative;
  box-shadow:var(--shadow);
}
.modal-close{
  position:absolute;
  top:0.75rem;
  right:0.75rem;
  background:none;
  border:none;
  color:var(--text-dim);
  font-size:1.5rem;
  cursor:pointer;
  line-height:1;
}
.modal-close:hover{
  color:var(--text);
}
.modal-subtitle{
  color:var(--text-dim);
  margin-top:0.25rem;
  margin-bottom:1rem;
}

/* Group view switching */
.group-view{
  text-align:center;
}
.group-view.hidden{
  display:none;
}
.group-view h2{
  margin:0 0 0.5rem;
  font-size:1.25rem;
}

/* Group options buttons */
.group-options{
  display:flex;
  gap:1rem;
  margin-top:1.5rem;
}
.group-option-btn{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:0.5rem;
  padding:1.25rem 0.75rem;
  background:rgba(255,255,255,0.05);
  border:1px solid var(--stroke);
  border-radius:12px;
  cursor:pointer;
  color:var(--text);
  transition:background 0.15s, border-color 0.15s;
}
.group-option-btn:hover{
  background:rgba(255,255,255,0.08);
  border-color:var(--yelp-red);
}
.option-icon{
  font-size:1.75rem;
  opacity:0.9;
}
.option-text{
  font-size:0.9rem;
  font-weight:500;
}

/* Group form */
.group-form{
  text-align:left;
  margin-top:1rem;
}
.group-form label{
  display:block;
  font-size:0.85rem;
  color:var(--text-dim);
  margin-bottom:0.35rem;
  margin-top:0.75rem;
}
.group-form input[type="text"]{
  width:100%;
  padding:0.6rem 0.75rem;
  font-size:0.95rem;
  background:rgba(0,0,0,0.4);
  border:1px solid var(--stroke);
  border-radius:8px;
  color:var(--text);
  outline:none;
}
.group-form input[type="text"]:focus{
  border-color:var(--yelp-red);
  box-shadow:0 0 0 2px var(--focus);
}
.group-form input[type="text"]::placeholder{
  color:var(--placeholder);
}
.group-submit-btn{
  width:100%;
  padding:0.65rem;
  margin-top:1.25rem;
  font-size:0.95rem;
  font-weight:500;
  background:linear-gradient(135deg, var(--yelp-red), var(--yelp-red-2));
  color:#fff;
  border:none;
  border-radius:8px;
  cursor:pointer;
  transition:transform 0.1s;
}
.group-submit-btn:active{
  transform:scale(0.98);
}
.group-back-btn{
  width:100%;
  padding:0.5rem;
  margin-top:0.5rem;
  font-size:0.85rem;
  background:transparent;
  color:var(--text-dim);
  border:none;
  cursor:pointer;
}
.group-back-btn:hover{
  color:var(--text);
}

/* Share link box */
.share-link-box{
  display:flex;
  gap:0.5rem;
  margin:1rem 0;
}
.share-link-box input{
  flex:1;
  padding:0.55rem 0.75rem;
  font-size:0.85rem;
  background:rgba(0,0,0,0.4);
  border:1px solid var(--stroke);
  border-radius:8px;
  color:var(--text);
  outline:none;
}
.copy-btn{
  padding:0.55rem 0.85rem;
  font-size:0.85rem;
  background:rgba(255,255,255,0.1);
  border:1px solid var(--stroke);
  border-radius:8px;
  color:var(--text);
  cursor:pointer;
}
.copy-btn:hover{
  background:rgba(255,255,255,0.15);
}

/* ========= GROUP CHAT SCREEN ========= */
.group-layout{
  flex:1;
  display:flex;
  overflow:hidden;
}

/* Restaurant sidebar */
.group-sidebar{
  width:220px;
  flex:0 0 220px;
  background:rgba(0,0,0,0.3);
  border-right:1px solid var(--stroke);
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
.sidebar-header{
  padding:0.75rem;
  border-bottom:1px solid var(--stroke);
}
.sidebar-header h3{
  margin:0;
  font-size:0.9rem;
  font-weight:500;
}
.restaurant-list{
  flex:1;
  overflow-y:auto;
  padding:0.5rem;
}
.empty-state{
  color:var(--text-dim);
  font-size:0.85rem;
  text-align:center;
  padding:1rem 0.5rem;
}

/* Restaurant card */
.restaurant-card{
  background:rgba(255,255,255,0.04);
  border:1px solid var(--stroke);
  border-radius:10px;
  padding:0.65rem;
  margin-bottom:0.5rem;
}
.restaurant-name{
  font-weight:500;
  font-size:0.9rem;
  margin-bottom:0.25rem;
}
.restaurant-meta{
  font-size:0.8rem;
  color:var(--text-dim);
}
.restaurant-shared-by{
  font-size:0.75rem;
  color:var(--placeholder);
  margin-top:0.35rem;
}
.yelp-link{
  display:inline-block;
  margin-top:0.35rem;
  font-size:0.8rem;
  color:var(--yelp-red);
  text-decoration:none;
}
.yelp-link:hover{
  text-decoration:underline;
}

/* Group main chat area */
.group-main{
  flex:1;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
.group-chat{
  flex:1;
  overflow-y:auto;
}

/* Group messages */
.group-message{
  max-width:75%;
}
.message-other{
  background:rgba(40,40,55,0.95);
  border:1px solid var(--stroke);
}
.message-author{
  display:block;
  font-size:0.75rem;
  color:var(--yelp-red);
  margin-bottom:0.2rem;
  font-weight:500;
}
.system-message{
  max-width:100%;
  text-align:center;
  background:transparent;
  color:var(--text-dim);
  font-size:0.8rem;
  padding:0.35rem 0;
  border:none;
}

/* Restaurant share message */
.restaurant-message{
  max-width:85%;
  background:rgba(20,20,30,0.9);
  border:1px solid var(--stroke);
}
.shared-restaurant{
  margin-top:0.4rem;
  padding:0.5rem;
  background:rgba(255,255,255,0.03);
  border-radius:8px;
}
.shared-restaurant strong{
  display:block;
  margin-bottom:0.25rem;
}
.shared-restaurant .rating,
.shared-restaurant .price{
  margin-right:0.5rem;
  font-size:0.85rem;
}

/* Group header extras */
.group-members-count{
  font-size:0.75rem;
  color:var(--text-dim);
}

/* Mobile responsive */
@media (max-width:600px){
  .group-sidebar{
    display:none;
  }
  .group-layout{
    flex-direction:column;
  }
}

/* Increase header button area for groups */
.header-right{
  display:flex;
  gap:0.4rem;
  justify-content:flex-end;
}
.app-header--grid{
  grid-template-columns: 70px 1fr auto;
}

/* ========= VOTING ========= */
.vote-section{
  display:flex;
  align-items:center;
  gap:0.5rem;
  margin-top:0.5rem;
}
.vote-btn{
  display:flex;
  align-items:center;
  gap:0.3rem;
  padding:0.35rem 0.6rem;
  font-size:0.85rem;
  background:rgba(255,255,255,0.06);
  border:1px solid var(--stroke);
  border-radius:999px;
  color:var(--text);
  cursor:pointer;
  transition:background 0.15s, border-color 0.15s, transform 0.1s;
}
.vote-btn:hover{
  background:rgba(255,255,255,0.12);
  border-color:var(--yelp-red);
}
.vote-btn:active{
  transform:scale(0.95);
}
.vote-btn.voted{
  background:rgba(211,35,35,0.2);
  border-color:var(--yelp-red);
  color:var(--yelp-red);
}
.voter-names{
  font-size:0.7rem;
  color:var(--placeholder);
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  max-width:100px;
}

/* Winner card highlight */
.restaurant-card.winner{
  background:linear-gradient(135deg, rgba(211,35,35,0.15), rgba(255,169,46,0.1));
  border-color:var(--yelp-red);
  position:relative;
}
.winner-badge{
  position:absolute;
  top:-8px;
  right:8px;
  background:linear-gradient(135deg, var(--yelp-red), #ff6b35);
  color:#fff;
  font-size:0.65rem;
  font-weight:600;
  padding:0.2rem 0.5rem;
  border-radius:999px;
  text-transform:uppercase;
  letter-spacing:0.03em;
}
